export SSS=/mnt/lustre/a2fs-nvme/work/e01/e01/ttuw_archer2

mkdir source
cd source
wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
bash <conda-installer-name>-latest-Linux-x86_64.sh
#conda installation directory: /mnt/lustre/a2fs-nvme/work/e01/e01/ttuw_archer2/source/miniconda3
conda create -n pyfr2
conda activate pyfr2
conda install python

module unload PrgEnv-cray/8.3.3

conda install -c conda-forge gxx conda-forge::fortran-compiler conda-forge::mpich conda-forge::scotch

cd $SSS/source && mkdir pyFRv2.0 && cd pyFRv2.0

git clone https://github.com/libxsmm/libxsmm.git
cd libxsmm
git checkout bf5313db8bf2edfc127bb715c36353e610ce7c04
make -j4 STATIC=0 BLAS=0
export PYFR_XSMM_LIBRARY_PATH=$SSS/source/pyFRv2.0/libxsmm/lib/libxsmm.so
cd ../

pip install pyfr
